#include "../base/basic_def.h"
#include "../base/fox_avx.h"
#include "../base/fox_pure.h"
#include "../base/fox_sse.h"
#include "operation.h"


constexpr double SinTop3Premute[360] = {0.00000000000000000000000000000000000,
                                        0.01745240643728351165320233917555015,
                                        0.03489949670250096919188464994476817,
                                        0.05233595624294382769869926619321632,
                                        0.06975647374412530243859009715379216,
                                        0.08715574274765816586985067715431796,
                                        0.10452846326765345696951925447137910,
                                        0.12186934340514747610040302561174030,
                                        0.13917310096006543784774578398355516,
                                        0.15643446504023086895962535436410690,
                                        0.17364817766693033118663436198403360,
                                        0.19080899537654480435655557357677026,
                                        0.20791169081775931481992358840216184,
                                        0.22495105434386497567089691074215807,
                                        0.24192189559966773004795470569661120,
                                        0.25881904510252073947640383266843855,
                                        0.27563735581699916332709676680678967,
                                        0.29237170472273671384400017814186867,
                                        0.30901699437494739575171820433752146,
                                        0.32556815445715669987691853748401627,
                                        0.34202014332566871290808308003761340,
                                        0.35836794954530026835470835067098960,
                                        0.37460659341591201476617811749747489,
                                        0.39073112848927371576479572468088008,
                                        0.40673664307580015275789264705963433,
                                        0.42261826174069944128675047068099957,
                                        0.43837114678907740383806412864942104,
                                        0.45399049973954674896958749741315842,
                                        0.46947156278589080580232462125422899,
                                        0.48480962024633705853560172727156896,
                                        0.49999999999999994448884876874217298,
                                        0.51503807491005415553075863499543630,
                                        0.52991926423320490080470790417166427,
                                        0.54463903501502697324099244724493474,
                                        0.55919290347074679381478290451923385,
                                        0.57357643635104604840080355643294752,
                                        0.58778525229247313710345679282909259,
                                        0.60181502315204826736305676604388282,
                                        0.61566147532565829170181359586422332,
                                        0.62932039104983750199551195692038164,
                                        0.64278760968653925189641995530109853,
                                        0.65605902899050727583585285174194723,
                                        0.66913060635885823757007528911344707,
                                        0.68199836006249847653037932104780339,
                                        0.69465837045899725410436076344922185,
                                        0.70710678118654746171500846685376018,
                                        0.71933980033865108083546147099696100,
                                        0.73135370161917045983557272847974673,
                                        0.74314482547739413309528799800318666,
                                        0.75470958022277190302418148348806426,
                                        0.76604444311897801345168090847437270,
                                        0.77714596145697079077052649154211394,
                                        0.78801075360672190317501417666790076,
                                        0.79863551004729282922767197305802256,
                                        0.80901699437494745126286943559534848,
                                        0.81915204428899179855960710483486764,
                                        0.82903757255504173517834942686022259,
                                        0.83867056794542393927116563645540737,
                                        0.84804809615642595677087456351728179,
                                        0.85716730070211222258791394779109396,
                                        0.86602540378443859658830206171842292,
                                        0.87461970713939574118001019087387249,
                                        0.88294759285892687739050188611145131,
                                        0.89100652418836778778654661437030882,
                                        0.89879404629916703761693952401401475,
                                        0.90630778703664993667388216636027209,
                                        0.91354545764260086659902526662335731,
                                        0.92050485345244037471701403774204664,
                                        0.92718385456678731326718434502254240,
                                        0.93358042649720174299687869279296137,
                                        0.93969262078590831688273965482949279,
                                        0.94551857559931673513631267269374803,
                                        0.95105651629515353118193843329208903,
                                        0.95630475596303543550646963922190480,
                                        0.96126169593831889415014302358031273,
                                        0.96592582628906831221371476203785278,
                                        0.97029572627599647294260876151383854,
                                        0.97437006478523524588553073044749908,
                                        0.97814760073380568883294472470879555,
                                        0.98162718344766397571277138922596350,
                                        0.98480775301220802031565426659653895,
                                        0.98768834059513777035022030759137124,
                                        0.99026806874157036197914294461952522,
                                        0.99254615164132198312785249072476290,
                                        0.99452189536827328986134943988872692,
                                        0.99619469809174554519870525837177411,
                                        0.99756405025982419765284703316865489,
                                        0.99862953475457383323288240717374720,
                                        0.99939082701909576211818375668372028,
                                        0.99984769515639126957751159352483228,
                                        1.00000000000000000000000000000000000,
                                        0.99984769515639126957751159352483228,
                                        0.99939082701909576211818375668372028,
                                        0.99862953475457383323288240717374720,
                                        0.99756405025982419765284703316865489,
                                        0.99619469809174554519870525837177411,
                                        0.99452189536827340088365190240438096,
                                        0.99254615164132209415015495324041694,
                                        0.99026806874157036197914294461952522,
                                        0.98768834059513765932791784507571720,
                                        0.98480775301220802031565426659653895,
                                        0.98162718344766397571277138922596350,
                                        0.97814760073380568883294472470879555,
                                        0.97437006478523524588553073044749908,
                                        0.97029572627599647294260876151383854,
                                        0.96592582628906831221371476203785278,
                                        0.96126169593831889415014302358031273,
                                        0.95630475596303554652877210173755884,
                                        0.95105651629515364220424089580774307,
                                        0.94551857559931684615861513520940207,
                                        0.93969262078590842790504211734514683,
                                        0.93358042649720174299687869279296137,
                                        0.92718385456678742428948680753819644,
                                        0.92050485345244037471701403774204664,
                                        0.91354545764260097762132772913901135,
                                        0.90630778703665004769618462887592614,
                                        0.89879404629916692659463706149836071,
                                        0.89100652418836789880884907688596286,
                                        0.88294759285892709943510681114275940,
                                        0.87461970713939585220231265338952653,
                                        0.86602540378443870761060452423407696,
                                        0.85716730070211233361021641030674800,
                                        0.84804809615642606779317702603293583,
                                        0.83867056794542393927116563645540737,
                                        0.82903757255504173517834942686022259,
                                        0.81915204428899202060421202986617573,
                                        0.80901699437494745126286943559534848,
                                        0.79863551004729271820536951054236852,
                                        0.78801075360672201419731663918355480,
                                        0.77714596145697101281513141657342203,
                                        0.76604444311897801345168090847437270,
                                        0.75470958022277212506878640851937234,
                                        0.74314482547739446616219538555014879,
                                        0.73135370161917057085787519099540077,
                                        0.71933980033865108083546147099696100,
                                        0.70710678118654757273731092936941423,
                                        0.69465837045899747614896568848052993,
                                        0.68199836006249858755268178356345743,
                                        0.66913060635885801552547036408213899,
                                        0.65605902899050727583585285174194723,
                                        0.64278760968653947394102488033240661,
                                        0.62932039104983739097320949440472759,
                                        0.61566147532565840272411605837987736,
                                        0.60181502315204860042996415359084494,
                                        0.58778525229247324812575925534474663,
                                        0.57357643635104593737850109391729347,
                                        0.55919290347074690483708536703488789,
                                        0.54463903501502730630789983479189686,
                                        0.52991926423320490080470790417166427,
                                        0.51503807491005437757536356002674438,
                                        0.49999999999999994448884876874217298,
                                        0.48480962024633716955790418978722300,
                                        0.46947156278589069478002215873857494,
                                        0.45399049973954685999188995992881246,
                                        0.43837114678907768139382028493855614,
                                        0.42261826174069949679790170193882659,
                                        0.40673664307580004173559018454398029,
                                        0.39073112848927377127594695593870711,
                                        0.37460659341591223681078304252878297,
                                        0.35836794954530065693276696947577875,
                                        0.34202014332566887944153677381109446,
                                        0.32556815445715658885461607496836223,
                                        0.30901699437494750677402066685317550,
                                        0.29237170472273704691090756568883080,
                                        0.27563735581699921883824799806461670,
                                        0.25881904510252101703215998895757366,
                                        0.24192189559966773004795470569661120,
                                        0.22495105434386519771550183577346615,
                                        0.20791169081775931481992358840216184,
                                        0.19080899537654497089000926735025132,
                                        0.17364817766693069200911736515990924,
                                        0.15643446504023097998192781687976094,
                                        0.13917310096006532682544332146790111,
                                        0.12186934340514754548934206468402408,
                                        0.10452846326765373452527541076051421,
                                        0.08715574274765819362542629278323147,
                                        0.06975647374412552448319502218510024,
                                        0.05233595624294425097122740453414735,
                                        0.03489949670250114266423224762547761,
                                        0.01745240643728343879481634814965219,
                                        0.00000000000000012246063538223772582,
                                        -0.01745240643728319246408275944304478,
                                        -0.03489949670250089980294561087248439,
                                        -0.05233595624294356402073091771853797,
                                        -0.06975647374412483059380463146226248,
                                        -0.08715574274765794382524575212300988,
                                        -0.10452846326765349860288267791474937,
                                        -0.12186934340514773977837137408641865,
                                        -0.13917310096006552111447263087029569,
                                        -0.15643446504023073018174727621953934,
                                        -0.17364817766693046996451244012860116,
                                        -0.19080899537654472108982872669002973,
                                        -0.20791169081775906501974304774194025,
                                        -0.22495105434386497567089691074215807,
                                        -0.24192189559966750800334978066530311,
                                        -0.25881904510252035089834521386364941,
                                        -0.27563735581699860821558445422851946,
                                        -0.29237170472273676935515140939969569,
                                        -0.30901699437494772881862559188448358,
                                        -0.32556815445715675538806976874184329,
                                        -0.34202014332566865739693184877978638,
                                        -0.35836794954530043488816204444447067,
                                        -0.37460659341591201476617811749747489,
                                        -0.39073112848927354923134203090739902,
                                        -0.40673664307579981969098525951267220,
                                        -0.42261826174069927475329677690751851,
                                        -0.43837114678907707077115674110245891,
                                        -0.45399049973954624936922641609271523,
                                        -0.46947156278589047273541723370726686,
                                        -0.48480962024633733609135788356070407,
                                        -0.50000000000000011102230246251565404,
                                        -0.51503807491005415553075863499543630,
                                        -0.52991926423320478978240544165601023,
                                        -0.54463903501502708426329490976058878,
                                        -0.55919290347074668279248044200357981,
                                        -0.57357643635104582635619863140163943,
                                        -0.58778525229247302608115433031343855,
                                        -0.60181502315204804531845184101257473,
                                        -0.61566147532565784761260374580160715,
                                        -0.62932039104983716892860456937341951,
                                        -0.64278760968653925189641995530109853,
                                        -0.65605902899050738685815531425760128,
                                        -0.66913060635885823757007528911344707,
                                        -0.68199836006249836550807685853214934,
                                        -0.69465837045899736512666322596487589,
                                        -0.70710678118654746171500846685376018,
                                        -0.71933980033865085879085654596565291,
                                        -0.73135370161917045983557272847974673,
                                        -0.74314482547739402207298553548753262,
                                        -0.75470958022277168097957655845675617,
                                        -0.76604444311897790242937844595871866,
                                        -0.77714596145697112383743387908907607,
                                        -0.78801075360672212521961910169920884,
                                        -0.79863551004729282922767197305802256,
                                        -0.80901699437494734024056697307969444,
                                        -0.81915204428899157651500217980355956,
                                        -0.82903757255504140211144203931326047,
                                        -0.83867056794542405029346809897106141,
                                        -0.84804809615642595677087456351728179,
                                        -0.85716730070211211156561148527543992,
                                        -0.86602540378443837454369713668711483,
                                        -0.87461970713939551913540526584256440,
                                        -0.88294759285892698841280434862710536,
                                        -0.89100652418836778778654661437030882,
                                        -0.89879404629916681557233459898270667,
                                        -0.90630778703665004769618462887592614,
                                        -0.91354545764260097762132772913901135,
                                        -0.92050485345244026369471157522639260,
                                        -0.92718385456678731326718434502254240,
                                        -0.93358042649720163197457623027730733,
                                        -0.93969262078590820586043719231383875,
                                        -0.94551857559931684615861513520940207,
                                        -0.95105651629515353118193843329208903,
                                        -0.95630475596303532448416717670625076,
                                        -0.96126169593831900517244548609596677,
                                        -0.96592582628906831221371476203785278,
                                        -0.97029572627599647294260876151383854,
                                        -0.97437006478523513486322826793184504,
                                        -0.97814760073380557781064226219314151,
                                        -0.98162718344766397571277138922596350,
                                        -0.98480775301220802031565426659653895,
                                        -0.98768834059513765932791784507571720,
                                        -0.99026806874157025095684048210387118,
                                        -0.99254615164132198312785249072476290,
                                        -0.99452189536827328986134943988872692,
                                        -0.99619469809174554519870525837177411,
                                        -0.99756405025982419765284703316865489,
                                        -0.99862953475457394425518486968940124,
                                        -0.99939082701909576211818375668372028,
                                        -0.99984769515639126957751159352483228,
                                        -1.00000000000000000000000000000000000,
                                        -0.99984769515639126957751159352483228,
                                        -0.99939082701909576211818375668372028,
                                        -0.99862953475457394425518486968940124,
                                        -0.99756405025982430867514949568430893,
                                        -0.99619469809174554519870525837177411,
                                        -0.99452189536827328986134943988872692,
                                        -0.99254615164132198312785249072476290,
                                        -0.99026806874157036197914294461952522,
                                        -0.98768834059513777035022030759137124,
                                        -0.98480775301220813133795672911219299,
                                        -0.98162718344766408673507385174161755,
                                        -0.97814760073380557781064226219314151,
                                        -0.97437006478523524588553073044749908,
                                        -0.97029572627599658396491122402949259,
                                        -0.96592582628906842323601722455350682,
                                        -0.96126169593831900517244548609596677,
                                        -0.95630475596303543550646963922190480,
                                        -0.95105651629515364220424089580774307,
                                        -0.94551857559931695718091759772505611,
                                        -0.93969262078590831688273965482949279,
                                        -0.93358042649720174299687869279296137,
                                        -0.92718385456678742428948680753819644,
                                        -0.92050485345244048573931650025770068,
                                        -0.91354545764260108864363019165466540,
                                        -0.90630778703665026974078955390723422,
                                        -0.89879404629916703761693952401401475,
                                        -0.89100652418836789880884907688596286,
                                        -0.88294759285892709943510681114275940,
                                        -0.87461970713939563015770772835821845,
                                        -0.86602540378443859658830206171842292,
                                        -0.85716730070211233361021641030674800,
                                        -0.84804809615642617881547948854858987,
                                        -0.83867056794542427233807302400236949,
                                        -0.82903757255504162415604696434456855,
                                        -0.81915204428899179855960710483486764,
                                        -0.80901699437494756228517189811100252,
                                        -0.79863551004729305127227689808933064,
                                        -0.78801075360672234726422402673051693,
                                        -0.77714596145697134588203880412038416,
                                        -0.76604444311897812447398337099002674,
                                        -0.75470958022277223609108887103502639,
                                        -0.74314482547739402207298553548753262,
                                        -0.73135370161917034881327026596409269,
                                        -0.71933980033865119185776393351261504,
                                        -0.70710678118654768375961339188506827,
                                        -0.69465837045899758717126815099618398,
                                        -0.68199836006249892061958917111041956,
                                        -0.66913060635885879268158760169171728,
                                        -0.65605902899050738685815531425760128,
                                        -0.64278760968653958496332734284806065,
                                        -0.62932039104983716892860456937341951,
                                        -0.61566147532565818067951113334856927,
                                        -0.60181502315204826736305676604388282,
                                        -0.58778525229247335914806171786040068,
                                        -0.57357643635104649249001340649556369,
                                        -0.55919290347074734892629521709750406,
                                        -0.54463903501502697324099244724493474,
                                        -0.52991926423320501182701036668731831,
                                        -0.51503807491005448859766602254239842,
                                        -0.50000000000000044408920985006261617,
                                        -0.48480962024633766915826527110766619,
                                        -0.46947156278589080580232462125422899,
                                        -0.45399049973954697101419242244446650,
                                        -0.43837114678907779241612274745421018,
                                        -0.42261826174069921924214554564969148,
                                        -0.40673664307580015275789264705963433,
                                        -0.39073112848927388229824941845436115,
                                        -0.37460659341591234783308550504443701,
                                        -0.35836794954530076795506943199143279,
                                        -0.34202014332566943455304908638936467,
                                        -0.32556815445715669987691853748401627,
                                        -0.30901699437494761779632312936882954,
                                        -0.29237170472273715793321002820448484,
                                        -0.27563735581699894128249184177548159,
                                        -0.25881904510252068396525260141061153,
                                        -0.24192189559966786882583278384117875,
                                        -0.22495105434386533649337991391803371,
                                        -0.20791169081775986993143590098043205,
                                        -0.19080899537654466557867749543220270,
                                        -0.17364817766693038669778559324186062,
                                        -0.15643446504023109100423027939541498,
                                        -0.13917310096006588193695563404617133,
                                        -0.12186934340514811447864218507675105,
                                        -0.10452846326765430351457553115324117,
                                        -0.08715574274765831852551656311334227,
                                        -0.06975647374412563550549748470075428,
                                        -0.05233595624294348075400407083179743,
                                        -0.03489949670250082347511266789297224,
                                        -0.01745240643728356022545966652614879};

constexpr double CosTop3Premute[360] = {1.00000000000000000000000000000000000,
                                        0.99984769515639126957751159352483228,
                                        0.99939082701909576211818375668372028,
                                        0.99862953475457383323288240717374720,
                                        0.99756405025982419765284703316865489,
                                        0.99619469809174554519870525837177411,
                                        0.99452189536827328986134943988872692,
                                        0.99254615164132198312785249072476290,
                                        0.99026806874157036197914294461952522,
                                        0.98768834059513777035022030759137124,
                                        0.98480775301220802031565426659653895,
                                        0.98162718344766397571277138922596350,
                                        0.97814760073380568883294472470879555,
                                        0.97437006478523524588553073044749908,
                                        0.97029572627599647294260876151383854,
                                        0.96592582628906831221371476203785278,
                                        0.96126169593831889415014302358031273,
                                        0.95630475596303554652877210173755884,
                                        0.95105651629515353118193843329208903,
                                        0.94551857559931684615861513520940207,
                                        0.93969262078590842790504211734514683,
                                        0.93358042649720174299687869279296137,
                                        0.92718385456678742428948680753819644,
                                        0.92050485345244037471701403774204664,
                                        0.91354545764260086659902526662335731,
                                        0.90630778703664993667388216636027209,
                                        0.89879404629916703761693952401401475,
                                        0.89100652418836789880884907688596286,
                                        0.88294759285892698841280434862710536,
                                        0.87461970713939574118001019087387249,
                                        0.86602540378443870761060452423407696,
                                        0.85716730070211233361021641030674800,
                                        0.84804809615642595677087456351728179,
                                        0.83867056794542405029346809897106141,
                                        0.82903757255504173517834942686022259,
                                        0.81915204428899179855960710483486764,
                                        0.80901699437494745126286943559534848,
                                        0.79863551004729282922767197305802256,
                                        0.78801075360672190317501417666790076,
                                        0.77714596145697090179282895405776799,
                                        0.76604444311897801345168090847437270,
                                        0.75470958022277201404648394600371830,
                                        0.74314482547739424411759046051884070,
                                        0.73135370161917045983557272847974673,
                                        0.71933980033865119185776393351261504,
                                        0.70710678118654757273731092936941423,
                                        0.69465837045899736512666322596487589,
                                        0.68199836006249847653037932104780339,
                                        0.66913060635885823757007528911344707,
                                        0.65605902899050738685815531425760128,
                                        0.64278760968653936291872241781675257,
                                        0.62932039104983750199551195692038164,
                                        0.61566147532565829170181359586422332,
                                        0.60181502315204837838535922855953686,
                                        0.58778525229247313710345679282909259,
                                        0.57357643635104615942310601894860156,
                                        0.55919290347074679381478290451923385,
                                        0.54463903501502719528559737227624282,
                                        0.52991926423320490080470790417166427,
                                        0.51503807491005437757536356002674438,
                                        0.50000000000000011102230246251565404,
                                        0.48480962024633711404675295852939598,
                                        0.46947156278589086131347585251205601,
                                        0.45399049973954680448073872867098544,
                                        0.43837114678907745934921535990724806,
                                        0.42261826174069944128675047068099957,
                                        0.40673664307580037480249757209094241,
                                        0.39073112848927371576479572468088008,
                                        0.37460659341591218129963181127095595,
                                        0.35836794954530015733240588815533556,
                                        0.34202014332566882393038554255326744,
                                        0.32556815445715675538806976874184329,
                                        0.30901699437494745126286943559534848,
                                        0.29237170472273676935515140939969569,
                                        0.27563735581699916332709676680678967,
                                        0.25881904510252073947640383266843855,
                                        0.24192189559966767453680347443878418,
                                        0.22495105434386514220435060451563913,
                                        0.20791169081775923155319674151542131,
                                        0.19080899537654491537885803609242430,
                                        0.17364817766693041445336120887077413,
                                        0.15643446504023092447077658562193392,
                                        0.13917310096006546560332139961246867,
                                        0.12186934340514748997819083342619706,
                                        0.10452846326765345696951925447137910,
                                        0.08715574274765836015887998655671254,
                                        0.06975647374412523304965105808150838,
                                        0.05233595624294396647657734433778387,
                                        0.03489949670250108021418711246042221,
                                        0.01745240643728359838937613801590487,
                                        0.00000000000000006123031769111886291,
                                        -0.01745240643728347695873281963940826,
                                        -0.03489949670250073326949191709900333,
                                        -0.05233595624294384157648707400767307,
                                        -0.06975647374412533019416571278270567,
                                        -0.08715574274765823525878971622660174,
                                        -0.10452846326765333206942898414126830,
                                        -0.12186934340514736507810056309608626,
                                        -0.13917310096006513253641401206550654,
                                        -0.15643446504023103549307904813758796,
                                        -0.17364817766693030343105874635512009,
                                        -0.19080899537654480435655557357677026,
                                        -0.20791169081775912053089427899976727,
                                        -0.22495105434386480913744321696867701,
                                        -0.24192189559966756351450101192313014,
                                        -0.25881904510252085049870629518409260,
                                        -0.27563735581699905230479430429113563,
                                        -0.29237170472273665833284894688404165,
                                        -0.30901699437494734024056697307969444,
                                        -0.32556815445715642232116238119488116,
                                        -0.34202014332566871290808308003761340,
                                        -0.35836794954530026835470835067098960,
                                        -0.37460659341591207027732934875530191,
                                        -0.39073112848927360474249326216522604,
                                        -0.40673664307580004173559018454398029,
                                        -0.42261826174069933026444800816534553,
                                        -0.43837114678907751486036659116507508,
                                        -0.45399049973954669345843626615533140,
                                        -0.46947156278589052824656846496509388,
                                        -0.48480962024633700302445049601374194,
                                        -0.49999999999999977795539507496869192,
                                        -0.51503807491005426655306109751109034,
                                        -0.52991926423320478978240544165601023,
                                        -0.54463903501502708426329490976058878,
                                        -0.55919290347074668279248044200357981,
                                        -0.57357643635104582635619863140163943,
                                        -0.58778525229247302608115433031343855,
                                        -0.60181502315204837838535922855953686,
                                        -0.61566147532565829170181359586422332,
                                        -0.62932039104983727995090703188907355,
                                        -0.64278760968653936291872241781675257,
                                        -0.65605902899050716481355038922629319,
                                        -0.66913060635885790450316790156648494,
                                        -0.68199836006249836550807685853214934,
                                        -0.69465837045899736512666322596487589,
                                        -0.70710678118654746171500846685376018,
                                        -0.71933980033865096981315900848130696,
                                        -0.73135370161917045983557272847974673,
                                        -0.74314482547739435513989292303449474,
                                        -0.75470958022277201404648394600371830,
                                        -0.76604444311897790242937844595871866,
                                        -0.77714596145697090179282895405776799,
                                        -0.78801075360672190317501417666790076,
                                        -0.79863551004729260718306704802671447,
                                        -0.80901699437494734024056697307969444,
                                        -0.81915204428899190958190956735052168,
                                        -0.82903757255504162415604696434456855,
                                        -0.83867056794542393927116563645540737,
                                        -0.84804809615642595677087456351728179,
                                        -0.85716730070211222258791394779109396,
                                        -0.86602540378443870761060452423407696,
                                        -0.87461970713939574118001019087387249,
                                        -0.88294759285892698841280434862710536,
                                        -0.89100652418836778778654661437030882,
                                        -0.89879404629916681557233459898270667,
                                        -0.90630778703664993667388216636027209,
                                        -0.91354545764260097762132772913901135,
                                        -0.92050485345244037471701403774204664,
                                        -0.92718385456678731326718434502254240,
                                        -0.93358042649720163197457623027730733,
                                        -0.93969262078590831688273965482949279,
                                        -0.94551857559931684615861513520940207,
                                        -0.95105651629515353118193843329208903,
                                        -0.95630475596303543550646963922190480,
                                        -0.96126169593831889415014302358031273,
                                        -0.96592582628906820119141229952219874,
                                        -0.97029572627599647294260876151383854,
                                        -0.97437006478523513486322826793184504,
                                        -0.97814760073380568883294472470879555,
                                        -0.98162718344766397571277138922596350,
                                        -0.98480775301220802031565426659653895,
                                        -0.98768834059513765932791784507571720,
                                        -0.99026806874157036197914294461952522,
                                        -0.99254615164132198312785249072476290,
                                        -0.99452189536827328986134943988872692,
                                        -0.99619469809174554519870525837177411,
                                        -0.99756405025982419765284703316865489,
                                        -0.99862953475457383323288240717374720,
                                        -0.99939082701909576211818375668372028,
                                        -0.99984769515639126957751159352483228,
                                        -1.00000000000000000000000000000000000,
                                        -0.99984769515639126957751159352483228,
                                        -0.99939082701909576211818375668372028,
                                        -0.99862953475457383323288240717374720,
                                        -0.99756405025982430867514949568430893,
                                        -0.99619469809174554519870525837177411,
                                        -0.99452189536827328986134943988872692,
                                        -0.99254615164132198312785249072476290,
                                        -0.99026806874157025095684048210387118,
                                        -0.98768834059513777035022030759137124,
                                        -0.98480775301220802031565426659653895,
                                        -0.98162718344766397571277138922596350,
                                        -0.97814760073380568883294472470879555,
                                        -0.97437006478523524588553073044749908,
                                        -0.97029572627599647294260876151383854,
                                        -0.96592582628906842323601722455350682,
                                        -0.96126169593831900517244548609596677,
                                        -0.95630475596303543550646963922190480,
                                        -0.95105651629515353118193843329208903,
                                        -0.94551857559931673513631267269374803,
                                        -0.93969262078590842790504211734514683,
                                        -0.93358042649720174299687869279296137,
                                        -0.92718385456678742428948680753819644,
                                        -0.92050485345244037471701403774204664,
                                        -0.91354545764260108864363019165466540,
                                        -0.90630778703665004769618462887592614,
                                        -0.89879404629916714863924198652966879,
                                        -0.89100652418836812085345400191727094,
                                        -0.88294759285892709943510681114275940,
                                        -0.87461970713939563015770772835821845,
                                        -0.86602540378443859658830206171842292,
                                        -0.85716730070211233361021641030674800,
                                        -0.84804809615642606779317702603293583,
                                        -0.83867056794542405029346809897106141,
                                        -0.82903757255504184620065188937587664,
                                        -0.81915204428899202060421202986617573,
                                        -0.80901699437494756228517189811100252,
                                        -0.79863551004729305127227689808933064,
                                        -0.78801075360672223624192156421486288,
                                        -0.77714596145697101281513141657342203,
                                        -0.76604444311897801345168090847437270,
                                        -0.75470958022277190302418148348806426,
                                        -0.74314482547739424411759046051884070,
                                        -0.73135370161917057085787519099540077,
                                        -0.71933980033865108083546147099696100,
                                        -0.70710678118654768375961339188506827,
                                        -0.69465837045899758717126815099618398,
                                        -0.68199836006249858755268178356345743,
                                        -0.66913060635885845961468021414475515,
                                        -0.65605902899050760890276023928890936,
                                        -0.64278760968653947394102488033240661,
                                        -0.62932039104983716892860456937341951,
                                        -0.61566147532565806965720867083291523,
                                        -0.60181502315204826736305676604388282,
                                        -0.58778525229247324812575925534474663,
                                        -0.57357643635104638146771094397990964,
                                        -0.55919290347074723790399275458185002,
                                        -0.54463903501502697324099244724493474,
                                        -0.52991926423320501182701036668731831,
                                        -0.51503807491005448859766602254239842,
                                        -0.50000000000000044408920985006261617,
                                        -0.48480962024633761364711403984983917,
                                        -0.46947156278589075029117338999640197,
                                        -0.45399049973954691550304119118663948,
                                        -0.43837114678907773690497151619638316,
                                        -0.42261826174069916373099431439186446,
                                        -0.40673664307580009724674141580180731,
                                        -0.39073112848927382678709818719653413,
                                        -0.37460659341591229232193427378660999,
                                        -0.35836794954530071244391820073360577,
                                        -0.34202014332566937904189785513153765,
                                        -0.32556815445715664436576730622618925,
                                        -0.30901699437494756228517189811100252,
                                        -0.29237170472273710242205879694665782,
                                        -0.27563735581699888577134061051765457,
                                        -0.25881904510252062845410137015278451,
                                        -0.24192189559966778555910593695443822,
                                        -0.22495105434386525322665306703129318,
                                        -0.20791169081775978666470905409369152,
                                        -0.19080899537654461006752626417437568,
                                        -0.17364817766693033118663436198403360,
                                        -0.15643446504023103549307904813758796,
                                        -0.13917310096006582642580440278834431,
                                        -0.12186934340514804508970314600446727,
                                        -0.10452846326765423412563649208095740,
                                        -0.08715574274765824913657752404105850,
                                        -0.06975647374412557999434625344292726,
                                        -0.05233595624294342524285283957397041,
                                        -0.03489949670250076102506753272791684,
                                        -0.01745240643728349777541453136109340,
                                        -0.00000000000000018369095307335658873,
                                        0.01745240643728313001403762427798938,
                                        0.03489949670250039326369062564481283,
                                        0.05233595624294305748147593249086640,
                                        0.06975647374412521917186325026705163,
                                        0.08715574274765788831409452086518286,
                                        0.10452846326765387330315348890508176,
                                        0.12186934340514768426722014282859163,
                                        0.13917310096006546560332139961246867,
                                        0.15643446504023067467059604496171232,
                                        0.17364817766692997036415135880815797,
                                        0.19080899537654424924504326099850005,
                                        0.20791169081775942584222605091781588,
                                        0.22495105434386492015974567948433105,
                                        0.24192189559966745249219854940747609,
                                        0.25881904510252029538719398260582238,
                                        0.27563735581699849719328199171286542,
                                        0.29237170472273671384400017814186867,
                                        0.30901699437494722921826451056404039,
                                        0.32556815445715631129885991867922712,
                                        0.34202014332566899046383923632674851,
                                        0.35836794954530037937701081318664365,
                                        0.37460659341591195925502688623964787,
                                        0.39073112848927349372019079964957200,
                                        0.40673664307579976417983402825484518,
                                        0.42261826174069883066408692684490234,
                                        0.43837114678907740383806412864942104,
                                        0.45399049973954663794728503489750437,
                                        0.46947156278589041722426600244943984,
                                        0.48480962024633728058020665230287705,
                                        0.50000000000000011102230246251565404,
                                        0.51503807491005415553075863499543630,
                                        0.52991926423320467876010297914035618,
                                        0.54463903501502664017408505969797261,
                                        0.55919290347074701585938782955054194,
                                        0.57357643635104604840080355643294752,
                                        0.58778525229247291505885186779778451,
                                        0.60181502315204793429614937849692069,
                                        0.61566147532565784761260374580160715,
                                        0.62932039104983683586169718182645738,
                                        0.64278760968653925189641995530109853,
                                        0.65605902899050705379124792671063915,
                                        0.66913060635885845961468021414475515,
                                        0.68199836006249858755268178356345743,
                                        0.69465837045899725410436076344922185,
                                        0.70710678118654735069270600433810614,
                                        0.71933980033865085879085654596565291,
                                        0.73135370161917001574636287841713056,
                                        0.74314482547739368900607814794057049,
                                        0.75470958022277190302418148348806426,
                                        0.76604444311897779140707598344306462,
                                        0.77714596145697112383743387908907607,
                                        0.78801075360672201419731663918355480,
                                        0.79863551004729282922767197305802256,
                                        0.80901699437494734024056697307969444,
                                        0.81915204428899157651500217980355956,
                                        0.82903757255504140211144203931326047,
                                        0.83867056794542405029346809897106141,
                                        0.84804809615642595677087456351728179,
                                        0.85716730070211211156561148527543992,
                                        0.86602540378443837454369713668711483,
                                        0.87461970713939540811310280332691036,
                                        0.88294759285892687739050188611145131,
                                        0.89100652418836778778654661437030882,
                                        0.89879404629916681557233459898270667,
                                        0.90630778703665004769618462887592614,
                                        0.91354545764260097762132772913901135,
                                        0.92050485345244026369471157522639260,
                                        0.92718385456678731326718434502254240,
                                        0.93358042649720152095227376776165329,
                                        0.93969262078590809483813472979818471,
                                        0.94551857559931684615861513520940207,
                                        0.95105651629515353118193843329208903,
                                        0.95630475596303532448416717670625076,
                                        0.96126169593831889415014302358031273,
                                        0.96592582628906831221371476203785278,
                                        0.97029572627599647294260876151383854,
                                        0.97437006478523513486322826793184504,
                                        0.97814760073380557781064226219314151,
                                        0.98162718344766397571277138922596350,
                                        0.98480775301220802031565426659653895,
                                        0.98768834059513765932791784507571720,
                                        0.99026806874157025095684048210387118,
                                        0.99254615164132198312785249072476290,
                                        0.99452189536827328986134943988872692,
                                        0.99619469809174554519870525837177411,
                                        0.99756405025982419765284703316865489,
                                        0.99862953475457394425518486968940124,
                                        0.99939082701909576211818375668372028,
                                        0.99984769515639126957751159352483228};

namespace fm {

FM_CALL double __do_Sin(double in) FMTHROW {
  double deg = fm::radToDeg(std::abs(in));
  int degree = deg;
  double rest = fm::degToRad(deg - degree);
  degree = degree % 360;

  double restSqr = rest * rest;
  double restQuad = restSqr * restSqr;
  auto vecSna = fm::simd::fmLoadVec(1, -0.16666666666666666666666666666,
                                    0.008333333333333333333333333, 0);
  auto vecSnb = fm::simd::fmLoadVec(rest, restSqr * rest, restQuad * rest, 0);
  auto vecCna = fm::simd::fmLoadVec(-0.5, 0.0416666666666666666666666666,
                                    0.0013888888888888888888888, 0);
  auto vecCnb = fm::simd::fmLoadVec(restSqr, restQuad, restQuad * restSqr, 0);
  double sn = fm::simd::fmVecDot(vecSna, vecSnb);
  double cn = fm::simd::fmVecDot(vecCna, vecCnb) + 1;
  double ret = SinTop3Premute[degree] * cn + CosTop3Premute[degree] * sn;
  return in < 0 ? -ret : ret;
}

FM_CALL double __do_Cos(double in) FMTHROW {
  double deg = fm::radToDeg(std::abs(in));
  int degree = deg;
  double rest = fm::degToRad(deg - degree);
  degree = degree % 360;

  double restSqr = rest * rest;
  double restQuad = restSqr * restSqr;
  auto vecSna = fm::simd::fmLoadVec(1, -0.16666666666666666666666666666,
                                    0.008333333333333333333333333, 0);
  auto vecSnb = fm::simd::fmLoadVec(rest, restSqr * rest, restQuad * rest, 0);
  auto vecCna = fm::simd::fmLoadVec(-0.5, 0.0416666666666666666666666666,
                                    0.0013888888888888888888888, 0);
  auto vecCnb = fm::simd::fmLoadVec(restSqr, restQuad, restQuad * restSqr, 0);
  double sn = fm::simd::fmVecDot(vecSna, vecSnb);
  double cn = fm::simd::fmVecDot(vecCna, vecCnb) + 1;
  double ret = CosTop3Premute[degree] * cn - SinTop3Premute[degree] * sn;
  return ret;
}

FM_CALL double __do_Tan(double in) FMTHROW {
  return __do_Sin(in) / __do_Cos(in);
}

FM_CALL double __do_Cot(double in) FMTHROW {
  return __do_Cos(in) / __do_Sin(in);
}

static FM_CALL double __arcTan1DivA(double a) FMTHROW;

FM_CALL double __do_Arctan(double in) FMTHROW {
  double ain = fm::abs(in) + 0.0000001;
  if (ain < 1) {
    double t = 1. / ain;
    auto tmp = __arcTan1DivA(t);
    return in < 0 ? -tmp : tmp;
  }else{
  auto tmp = fm::PIdiv2 - __arcTan1DivA(ain);
  return in < 0 ? -tmp : tmp;
  }
}

static FM_CALL double __arcTan1DivA(double a) FMTHROW {
  static const fm::simd::fmAlignFLoat4 aa1F{15159, 147455, 345345, 225225};
  static const fm::simd::fmAlignFLoat4 bb1F{1260 * 35, 6930 * 35, 12012 * 35,
                                            6435 * 35};
  double a2 = a * a;
  double a4 = a2 * a2;
  double a6 = a2 * a4;
  double a8 = a6 * a2;
  auto aa1 = simd::fmLoadVecP(aa1F._v);
  auto aa2 = simd::fmLoadVec(1, a2, a4, a6);
  auto top = simd::fmVecDot(aa1, aa2);
  auto bb1 = simd::fmLoadVecP(bb1F._v);
  auto bb2 = simd::fmLoadVec(a2, a4, a6, a8);
  auto down = 1225 + simd::fmVecDot(bb1, bb2);
  return top / down * a;
}

} // namespace fm